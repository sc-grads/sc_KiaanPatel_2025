name: SQL Server Deployment Pipeline

on:
  workflow_dispatch:

jobs:
  development:
    uses: ./.github/workflows/TestTemplate.yml
    with:
      server_type: "development"
      sql_script_path: "DatabaseAdministration/SQLStatements/ProductionAndDeploymentProject.sql"
    secrets:
      sql_password: ${{ secrets.SQL_PASSWORD }}
      server_url: ${{ secrets.PINGGY_URL }}

  production:
    needs: development
    uses: ./.github/workflows/TestTemplate.yml
    with:
      server_type: "production"
      sql_script_path: "DatabaseAdministration/SQLStatements/ProductionAndDeploymentProject.sql"
    secrets:
      sql_password: ${{ secrets.FRIEND_SQL_PASSWORD }}
      server_url: ${{ secrets.FRIEND_SERVER_URL }}
