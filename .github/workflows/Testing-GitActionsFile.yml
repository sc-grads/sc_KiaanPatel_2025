# Name of the workflow, displayed in the GitHub Actions UI.
name: Deploy SQL Database

# Define the events that will trigger this workflow.
on:
  push:
    # The workflow will only trigger when there are changes to the GitActionsDatabaseTestQuery.sql file.
    paths:
      - GitActionsDatabaseTestQuery.sql  # Runs only if this file changes
    
    # The workflow will run on pushes to the 'main' branch.
    branches:
      - main  # Runs only on the main branch

# Define the jobs that will run in this workflow.
jobs:
  deploy:
    # Specifies that this job will run on a self-hosted runner, meaning the job will execute on your local machine.
    runs-on: self-hosted  # Runs on your local machine

    # Define the steps to be executed as part of the job.
    steps:
      # Step 1: Checkout the repository so that the workflow can access the latest version of the repository files.
      - name: Checkout repository
        uses: actions/checkout@v3  # Fetches the latest repo files

      # Step 2: Execute the SQL script to create the database and tables.
      - name: Execute SQL Script
        run: |
          sqlcmd -S localhost -U sa -P YourPassword -i GitActionsDatabaseTestQuery.sql 
        shell: bash  # Specifies that the script should be executed using the bash shell
